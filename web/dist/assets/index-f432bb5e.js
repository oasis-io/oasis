/* empty css             *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                     */import"./el-form-item-4ed993c7.js";/* empty css                    *//* empty css                  */import{d as ae,r as n,a as G,o as i,c as V,j as p,b as l,w as t,h as c,g as T,F as E,s as U,t as z,af as I,ag as L,ah as le,ai as te,a0 as oe,aj as se,M as v,ak as de,al as ne,m as ue,Y as re,Z as ie,a1 as me,k as pe,l as ce,a2 as ve,a3 as fe,E as ge,a4 as be}from"./index-6dee63ee.js";const _e={class:"table-box"},ye={class:"button-left"},we={class:"pagination"},Ve={class:"dialog-footer"},ke={class:"dialog-footer"},Te=ae({__name:"index",setup(he){const D=n(0),b=n(1),_=n(10),P=n([]),O=n(!1),$=n(!1),q=n(!1),B=n(),R=n(),y=n(!1),w=n(!1),k=n([]),h=n([]),r=G({name:"",desc:"",users:[],roles:[]}),d=G({id:0,name:"",desc:"",users:[],roles:[]}),K=async()=>{y.value=!0;const o=await I();o.data.code===1e3&&(h.value=o.data.data.data.map(s=>({label:s,value:s})));const a=await L();a.data.code===1e3&&(k.value=a.data.data.data.map(s=>({label:s,value:s})))},M=G({name:[{required:!0,trigger:"blur"}]}),W=o=>{_.value=o,f()},Y=o=>{b.value=o,f()},f=async()=>{const o=await le({pageSize:_.value,currentPage:b.value});o.data.code===1e3&&(P.value=o.data.data.data,D.value=o.data.data.total,_.value=o.data.data.pageSize,b.value=o.data.data.currentPage)};f();const Z=async o=>{w.value=!0;const a=await te({name:o.name});a.data.code===1e3&&(d.id=a.data.data.data[0].id,d.name=a.data.data.data[0].name,d.desc=a.data.data.data[0].desc,d.users=a.data.data.data[0].users.map(u=>u.username),d.roles=a.data.data.data[0].roles.map(u=>u.name));const s=await I();s.data.code===1e3&&(h.value=s.data.data.data.map(u=>({label:u,value:u})));const g=await L();g.data.code===1e3&&(k.value=g.data.data.data.map(u=>({label:u,value:u})))},A=async o=>{oe.confirm("此操作将永久删除该用户组, 是否继续?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{(await se({name:o.name})).data.code===1e3?(v({type:"success",message:"用户组删除成功"}),await f()):v({type:"error",message:"用户组删除失败"})}).catch(()=>{v({type:"info",message:"取消删除用户组"})})},S=async()=>{B.value.resetFields(),y.value=!1},H=async()=>{B.value.validate(async o=>{o&&((await de(r)).data.code===1e3?(v({type:"success",message:"用户组创建成功"}),await f(),S()):v({type:"error",message:"用户组创建失败"}),y.value=!1)})},J=async()=>{R.value.resetFields(),w.value=!1},Q=async()=>{R.value.validate(async o=>{o&&((await ne(d)).data.code===1e3?(v({type:"success",message:"用户组更新成功"}),await f(),S()):v({type:"error",message:"用户组更新失败"}),w.value=!1)})};return(o,a)=>{const s=ue,g=re,u=ie,X=me,x=pe,m=ce,C=ve,F=fe,j=ge,N=be;return i(),V("div",_e,[p("div",ye,[l(s,{type:"primary",icon:"plus",onClick:T(K,["prevent"])},{default:t(()=>[c("新增用户组")]),_:1},8,["onClick"])]),l(u,{data:P.value,style:{width:"100%"}},{default:t(()=>[l(g,{align:"left",prop:"name",label:"用户组名","min-width":"150"}),l(g,{align:"left",prop:"desc",label:"描述","min-width":"180"}),l(g,{align:"left",label:"操作","min-width":"200"},{default:t(e=>[l(s,{icon:"edit",type:"primary",link:"",onClick:T(ee=>Z(e.row),["prevent"])},{default:t(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),l(s,{icon:"delete",type:"primary",link:"",onClick:T(ee=>A(e.row),["prevent"])},{default:t(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),p("div",we,[l(X,{"current-page":b.value,"onUpdate:currentPage":a[0]||(a[0]=e=>b.value=e),"page-size":_.value,"onUpdate:pageSize":a[1]||(a[1]=e=>_.value=e),"page-sizes":[10,20,50],small:O.value,disabled:q.value,background:$.value,layout:"total, sizes, prev, pager, next, jumper",total:D.value,onSizeChange:W,onCurrentChange:Y},null,8,["current-page","page-size","small","disabled","background","total"])]),p("div",null,[l(N,{modelValue:y.value,"onUpdate:modelValue":a[6]||(a[6]=e=>y.value=e),title:"创建用户组",width:"40%"},{footer:t(()=>[p("span",Ve,[l(s,{onClick:S},{default:t(()=>[c("关闭")]),_:1}),l(s,{type:"primary",onClick:H},{default:t(()=>[c("提交")]),_:1})])]),default:t(()=>[p("div",null,[l(j,{ref_key:"addFormRef",ref:B,model:r,"status-icon":"",rules:M,"label-width":"120px",style:{"max-width":"380px"},class:"demo-ruleForm"},{default:t(()=>[l(m,{label:"用户组名",prop:"name"},{default:t(()=>[l(x,{modelValue:r.name,"onUpdate:modelValue":a[2]||(a[2]=e=>r.name=e),maxlength:"30","show-word-limit":"",placeholder:"请输入用户组"},null,8,["modelValue"])]),_:1}),l(m,{label:"用户组描述",prop:"desc"},{default:t(()=>[l(x,{modelValue:r.desc,"onUpdate:modelValue":a[3]||(a[3]=e=>r.desc=e),maxlength:"50",rows:5,type:"textarea","show-word-limit":"",placeholder:"请输入用户组描述"},null,8,["modelValue"])]),_:1}),l(m,{label:"绑定用户",prop:"users"},{default:t(()=>[l(F,{modelValue:r.users,"onUpdate:modelValue":a[4]||(a[4]=e=>r.users=e),multiple:"",clearable:"",style:{width:"100%"},placeholder:"请选择用户"},{default:t(()=>[(i(!0),V(E,null,U(h.value,e=>(i(),z(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"绑定角色",prop:"roles"},{default:t(()=>[l(F,{modelValue:r.roles,"onUpdate:modelValue":a[5]||(a[5]=e=>r.roles=e),multiple:"",clearable:"",style:{width:"100%"},placeholder:"请选择角色"},{default:t(()=>[(i(!0),V(E,null,U(k.value,e=>(i(),z(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])]),p("div",null,[l(N,{modelValue:w.value,"onUpdate:modelValue":a[11]||(a[11]=e=>w.value=e),title:"编辑用户组",width:"40%"},{footer:t(()=>[p("span",ke,[l(s,{onClick:J},{default:t(()=>[c("关闭")]),_:1}),l(s,{type:"primary",onClick:Q},{default:t(()=>[c("提交")]),_:1})])]),default:t(()=>[p("div",null,[l(j,{ref_key:"editFormRef",ref:R,model:d,"status-icon":"",rules:M,"label-width":"120px",style:{"max-width":"380px"},class:"demo-ruleForm"},{default:t(()=>[l(m,{label:"用户组名",prop:"name"},{default:t(()=>[l(x,{modelValue:d.name,"onUpdate:modelValue":a[7]||(a[7]=e=>d.name=e),maxlength:"30","show-word-limit":"",placeholder:"请输入用户组"},null,8,["modelValue"])]),_:1}),l(m,{label:"用户组描述",prop:"desc"},{default:t(()=>[l(x,{modelValue:d.desc,"onUpdate:modelValue":a[8]||(a[8]=e=>d.desc=e),maxlength:"50",rows:5,type:"textarea","show-word-limit":"",placeholder:"请输入用户组描述"},null,8,["modelValue"])]),_:1}),l(m,{label:"绑定用户",prop:"users"},{default:t(()=>[l(F,{modelValue:d.users,"onUpdate:modelValue":a[9]||(a[9]=e=>d.users=e),multiple:"",clearable:"",style:{width:"100%"},placeholder:"请选择用户"},{default:t(()=>[(i(!0),V(E,null,U(h.value,e=>(i(),z(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"绑定角色",prop:"roles"},{default:t(()=>[l(F,{modelValue:d.roles,"onUpdate:modelValue":a[10]||(a[10]=e=>d.roles=e),multiple:"",clearable:"",style:{width:"100%"},placeholder:"请选择角色"},{default:t(()=>[(i(!0),V(E,null,U(k.value,e=>(i(),z(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])])])}}});export{Te as default};
