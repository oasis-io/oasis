/* empty css                  *//* empty css                        */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                   *//* empty css                    */import{d as G,r as o,a as b,o as z,c as H,j as m,b as e,w as l,h as p,g as y,t as J,x as Q,ab as X,a7 as ee,ac as ae,L as _,ad as te,m as le,Y as oe,Z as ne,$ as se,k as re,l as de,E as ie,a2 as ce,ae as ue,af as me,ag as pe}from"./index-95ad95c9.js";import _e from"./Menus-0e4a7263.js";import fe from"./Apis-08af234e.js";/* empty css                */const ge={class:"authority"},ve={class:"table-box"},we={class:"button-left"},be={class:"pagination"},ye={class:"dialog-footer"},Pe=G({__name:"index",setup(he){const h=o(0),r=o(1),d=o(10),k=o([]),T=o(!1),F=o(!1),B=o(!1),v=o();o();const i=o(!1);o(!1);const f=o(!1),g=o({name:"",age:0}),P=b({name:[{required:!0,trigger:"blur"}]}),D=a=>{d.value=a,c()},S=a=>{r.value=a,c()},c=async()=>{const a=await X({pageSize:d.value,currentPage:r.value});a.data.code===1e3&&(k.value=a.data.data.data,h.value=a.data.data.total,d.value=a.data.data.pageSize,r.value=a.data.data.currentPage)};c();const U=()=>{},C=(a,t)=>{g.value[a]=t},M=o(null),N=o(null),I=async a=>{ee.confirm("此操作将永久删除该角色, 是否继续?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{(await ae({name:a.name})).data.code===1e3?(_({type:"success",message:"角色删除成功"}),await c()):_({type:"error",message:"角色删除失败"})}).catch(()=>{_({type:"info",message:"取消删除角色"})})},$=()=>{i.value=!0},j=async a=>{f.value=!0,g.value=a},s=b({name:"",desc:""});b({name:"",desc:""});const x=async()=>{v.value.resetFields(),i.value=!1},A=async()=>{v.value.validate(async a=>{a&&((await te(s)).data.code===1e3?(_({type:"success",message:"角色创建成功"}),await c(),x()):_({type:"error",message:"角色创建失败"}),i.value=!1)})};return(a,t)=>{const u=le,w=oe,L=ne,q=se,E=re,V=de,K=ie,O=ce,R=ue,W=me,Y=pe;return z(),H("div",ge,[m("div",ve,[m("div",we,[e(u,{type:"primary",icon:"plus",onClick:y($,["prevent"])},{default:l(()=>[p("新增角色")]),_:1},8,["onClick"])]),e(L,{data:k.value,style:{width:"100%"}},{default:l(()=>[e(w,{align:"left",prop:"name",label:"角色名","min-width":"150"}),e(w,{align:"left",prop:"desc",label:"描述","min-width":"180"}),e(w,{align:"left",label:"操作","min-width":"200"},{default:l(n=>[e(u,{icon:"setting",type:"primary",link:"",onClick:y(Z=>j(n.row),["prevent"])},{default:l(()=>[p("设置权限")]),_:2},1032,["onClick"]),e(u,{icon:"delete",type:"primary",link:"",onClick:y(Z=>I(n.row),["prevent"])},{default:l(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),m("div",be,[e(q,{"current-page":r.value,"onUpdate:currentPage":t[0]||(t[0]=n=>r.value=n),"page-size":d.value,"onUpdate:pageSize":t[1]||(t[1]=n=>d.value=n),"page-sizes":[10,20,50],small:T.value,disabled:B.value,background:F.value,layout:"total, sizes, prev, pager, next, jumper",total:h.value,onSizeChange:D,onCurrentChange:S},null,8,["current-page","page-size","small","disabled","background","total"])]),e(O,{modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=n=>i.value=n),title:"创建角色",width:"40%"},{footer:l(()=>[m("span",ye,[e(u,{onClick:x},{default:l(()=>[p("关闭")]),_:1}),e(u,{type:"primary",onClick:A},{default:l(()=>[p("提交")]),_:1})])]),default:l(()=>[m("div",null,[e(K,{ref_key:"addFormRef",ref:v,model:s,"status-icon":"",rules:P,"label-width":"120px",style:{"max-width":"380px"},class:"demo-ruleForm"},{default:l(()=>[e(V,{label:"角色名",prop:"name"},{default:l(()=>[e(E,{modelValue:s.name,"onUpdate:modelValue":t[2]||(t[2]=n=>s.name=n),maxlength:"30","show-word-limit":"",placeholder:"请输入角色名"},null,8,["modelValue"])]),_:1}),e(V,{label:"角色描述",prop:"desc"},{default:l(()=>[e(E,{modelValue:s.desc,"onUpdate:modelValue":t[3]||(t[3]=n=>s.desc=n),maxlength:"50",rows:5,type:"textarea","show-word-limit":"",placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"]),f.value?(z(),J(Y,{key:0,modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=n=>f.value=n),"custom-class":"auth-drawer","with-header":!1,size:"40%",title:"角色配置"},{default:l(()=>[e(W,{"before-leave":U,type:"border-card"},{default:l(()=>[e(R,{label:"菜单权限"},{default:l(()=>[e(_e,{ref_key:"menus",ref:M,row:g.value,onChangeRow:C},null,8,["row"])]),_:1}),e(R,{label:"API权限"},{default:l(()=>[e(fe,{ref_key:"apis",ref:N,row:g.value,onChangeRow:C},null,8,["row"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):Q("",!0)])])}}});export{Pe as default};
